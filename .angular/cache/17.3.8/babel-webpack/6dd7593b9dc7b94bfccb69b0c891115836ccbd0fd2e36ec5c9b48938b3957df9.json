{"ast":null,"code":"import _asyncToGenerator from \"/workspaces/mercadito-front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { DeliveryPage } from '../delivery/delivery.page';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/cart.service\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nfunction CartPage_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"p\");\n    i0.ɵɵtext(2, \"Tu carrito esta vacio agrega productos\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-button\", 9);\n    i0.ɵɵtext(4, \"Productos\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction CartPage_ion_card_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-card\", 10)(1, \"ion-item\", 11)(2, \"ion-thumbnail\", 12);\n    i0.ɵɵelement(3, \"img\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-icon\", 14);\n    i0.ɵɵlistener(\"click\", function CartPage_ion_card_11_Template_ion_icon_click_4_listener() {\n      const i_r2 = i0.ɵɵrestoreView(_r1).index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.removeProduct(i_r2));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-note\", 15)(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"b\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const product_r4 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"src\", product_r4.imagen ? \"https://mercadito-app.azurewebsites.net/images/products/\" + product_r4.imagen : \"https://via.placeholder.com/150\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(product_r4.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"$\", product_r4.precio, \"\");\n  }\n}\nfunction CartPage_ion_footer_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-footer\")(1, \"ion-toolbar\")(2, \"ion-row\")(3, \"ion-col\")(4, \"p\", 16);\n    i0.ɵɵtext(5, \"Total\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 17)(7, \"b\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"number\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"ion-col\", 18)(11, \"ion-button\", 19);\n    i0.ɵɵlistener(\"click\", function CartPage_ion_footer_12_Template_ion_button_click_11_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.openDeliveryPage());\n    });\n    i0.ɵɵtext(12, \"Continuar \");\n    i0.ɵɵelement(13, \"i\", 20);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵtextInterpolate1(\"$\", i0.ɵɵpipeBind2(9, 1, ctx_r2.total, \"1.2-2\"), \"\");\n  }\n}\nexport let CartPage = /*#__PURE__*/(() => {\n  var _CartPage;\n  class CartPage {\n    constructor(cartService, modalController) {\n      this.cartService = cartService;\n      this.modalController = modalController;\n      this.cartProducts = [];\n      this.total = 0;\n    }\n    ngOnInit() {\n      this.loadCartProducts();\n      this.cartSubscription = this.cartService.getCartProducts().subscribe(products => {\n        this.cartProducts = products;\n        this.calculateTotal();\n      });\n    }\n    loadCartProducts() {\n      const cartProducts = localStorage.getItem('cartProducts');\n      if (cartProducts) {\n        this.cartProducts = JSON.parse(cartProducts);\n        this.cartService.setCartProducts(this.cartProducts); // Agrega esta línea\n        this.calculateTotal();\n      }\n    }\n    calculateTotal() {\n      this.total = this.cartProducts.reduce((acc, product) => acc + product.precio, 0);\n    }\n    removeProduct(index) {\n      this.cartProducts.splice(index, 1);\n      localStorage.setItem('cartProducts', JSON.stringify(this.cartProducts));\n      this.calculateTotal();\n      this.cartService.setCartProducts(this.cartProducts);\n    }\n    openDeliveryPage() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const modal = yield _this.modalController.create({\n          component: DeliveryPage,\n          componentProps: {\n            cartProducts: _this.cartProducts // Pasa los productos del carrito al modal\n          }\n        });\n        modal.onDidDismiss().then(dataReturned => {\n          if (dataReturned !== null) {\n            console.log('Modal Sent Data :', dataReturned);\n          }\n        });\n        return yield modal.present();\n      })();\n    }\n  }\n  _CartPage = CartPage;\n  _CartPage.ɵfac = function CartPage_Factory(t) {\n    return new (t || _CartPage)(i0.ɵɵdirectiveInject(i1.CartService), i0.ɵɵdirectiveInject(i2.ModalController));\n  };\n  _CartPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _CartPage,\n    selectors: [[\"app-cart\"]],\n    decls: 13,\n    vars: 5,\n    consts: [[3, \"translucent\"], [3, \"fullscreen\"], [\"collapse\", \"condense\"], [\"size\", \"large\"], [\"routerLink\", \"/tabs/home\", 1, \"fa-solid\", \"fa-arrow-left\"], [\"class\", \"ion-text-center\", 4, \"ngIf\"], [\"class\", \"ion-padding\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"ion-text-center\"], [\"color\", \"dark\", \"shape\", \"round\", \"routerLink\", \"/tabs/home\"], [1, \"ion-padding\"], [1, \"no-lines\"], [\"slot\", \"start\"], [\"alt\", \"Product Image\", 3, \"src\"], [\"color\", \"danger\", \"aria-hidden\", \"true\", \"name\", \"trash\", \"slot\", \"end\", 3, \"click\"], [\"color\", \"dark\"], [2, \"font-size\", \"12px\", \"margin-left\", \"10px\"], [2, \"font-size\", \"16px\", \"margin-left\", \"10px\", \"margin-top\", \"-10px\"], [1, \"ion-text-end\"], [\"shape\", \"round\", \"color\", \"dark\", 2, \"margin-top\", \"15px\", 3, \"click\"], [1, \"fa-solid\", \"fa-angle-right\"]],\n    template: function CartPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\")(2, \"ion-title\");\n        i0.ɵɵtext(3, \"Mi carrito\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(4, \"ion-content\", 1)(5, \"ion-header\", 2)(6, \"ion-toolbar\")(7, \"ion-title\", 3);\n        i0.ɵɵelement(8, \"i\", 4);\n        i0.ɵɵtext(9, \" Mi carrito\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(10, CartPage_div_10_Template, 5, 0, \"div\", 5)(11, CartPage_ion_card_11_Template, 10, 3, \"ion-card\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, CartPage_ion_footer_12_Template, 14, 4, \"ion-footer\", 7);\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"translucent\", true);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"fullscreen\", true);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngIf\", ctx.cartProducts.length === 0);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngForOf\", ctx.cartProducts);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"ngIf\", ctx.cartProducts.length > 0);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i2.IonButton, i2.IonCard, i2.IonCol, i2.IonContent, i2.IonFooter, i2.IonHeader, i2.IonIcon, i2.IonItem, i2.IonNote, i2.IonRow, i2.IonThumbnail, i2.IonTitle, i2.IonToolbar, i2.RouterLinkDelegate, i4.RouterLink, i3.DecimalPipe]\n  });\n  return CartPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}