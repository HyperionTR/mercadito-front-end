{"ast":null,"code":"import _asyncToGenerator from \"/workspaces/mercadito-front-end/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"src/app/services/api.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction DeliveryPage_ion_item_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\")(1, \"ion-label\", 16);\n    i0.ɵɵtext(2, \"Ingresa el lugar de entrega:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-input\", 17);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function DeliveryPage_ion_item_30_Template_ion_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.otherLocation, $event) || (ctx_r1.otherLocation = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.otherLocation);\n  }\n}\nexport let DeliveryPage = /*#__PURE__*/(() => {\n  var _DeliveryPage;\n  class DeliveryPage {\n    constructor(modalController, apiService, toastController, router) {\n      this.modalController = modalController;\n      this.apiService = apiService;\n      this.toastController = toastController;\n      this.router = router;\n      this.cartProducts = []; // Recibe los productos del carrito\n      this.selectedLocation = 'Palapas de gobierno'; // Valor por defecto\n      this.otherLocation = '';\n    }\n    ngOnInit() {}\n    onLocationChange() {\n      if (this.selectedLocation !== 'Otro') {\n        this.otherLocation = ''; // Limpia el campo \"Otro\" si se selecciona otra opción\n      }\n    }\n    confirmDelivery() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const lugarEntrega = _this.selectedLocation === 'Otro' ? _this.otherLocation : _this.selectedLocation;\n        const orderData = {\n          info: {\n            lugar_entrega: lugarEntrega\n          },\n          detalles: _this.cartProducts.map(product => ({\n            boleta_vendedor: product.boleta_vendedor,\n            id_producto: product.id_producto\n          }))\n        };\n        _this.apiService.createOrder(orderData).subscribe( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (response) {\n            console.log('Pedido creado:', response);\n            const toast = yield _this.toastController.create({\n              message: response,\n              duration: 2000,\n              position: 'top'\n            });\n            toast.present();\n            _this.modalController.dismiss(); // Cierra el modal después de crear el pedido\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }(), /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(function* (error) {\n            console.error('Error al crear el pedido:', error);\n            if (error.status === 401) {\n              _this.router.navigate(['/login']);\n            }\n            const toast = yield _this.toastController.create({\n              message: error.error,\n              duration: 2000,\n              position: 'top'\n            });\n            toast.present();\n          });\n          return function (_x2) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n      })();\n    }\n    closeModal() {\n      this.modalController.dismiss();\n    }\n  }\n  _DeliveryPage = DeliveryPage;\n  _DeliveryPage.ɵfac = function DeliveryPage_Factory(t) {\n    return new (t || _DeliveryPage)(i0.ɵɵdirectiveInject(i1.ModalController), i0.ɵɵdirectiveInject(i2.ApiService), i0.ɵɵdirectiveInject(i1.ToastController), i0.ɵɵdirectiveInject(i3.Router));\n  };\n  _DeliveryPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _DeliveryPage,\n    selectors: [[\"app-delivery\"]],\n    inputs: {\n      cartProducts: \"cartProducts\"\n    },\n    decls: 36,\n    vars: 4,\n    consts: [[3, \"translucent\"], [3, \"fullscreen\"], [\"collapse\", \"condense\"], [\"size\", \"large\"], [3, \"ngModelChange\", \"ionChange\", \"ngModel\"], [\"value\", \"Palapas de gobierno\"], [\"value\", \"Asta bandera / Letras\"], [\"value\", \"Barra de caf\\u00E9\"], [\"value\", \"Papeler\\u00EDa\"], [\"value\", \"Palapas de IA\"], [\"value\", \"Cafeter\\u00EDa\"], [\"value\", \"Laboratorios planta baja\"], [\"value\", \"Otro\"], [4, \"ngIf\"], [1, \"ion-text-center\"], [\"color\", \"dark\", \"shape\", \"round\", 3, \"click\"], [\"position\", \"floating\"], [3, \"ngModelChange\", \"ngModel\"]],\n    template: function DeliveryPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\")(2, \"ion-title\");\n        i0.ɵɵtext(3, \"Entrega\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(4, \"ion-content\", 1)(5, \"ion-header\", 2)(6, \"ion-toolbar\")(7, \"ion-title\", 3);\n        i0.ɵɵtext(8, \"Entrega\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(9, \"ion-list\")(10, \"ion-item\")(11, \"ion-label\");\n        i0.ɵɵtext(12, \"Lugar de entrega:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"ion-select\", 4);\n        i0.ɵɵtwoWayListener(\"ngModelChange\", function DeliveryPage_Template_ion_select_ngModelChange_13_listener($event) {\n          i0.ɵɵtwoWayBindingSet(ctx.selectedLocation, $event) || (ctx.selectedLocation = $event);\n          return $event;\n        });\n        i0.ɵɵlistener(\"ionChange\", function DeliveryPage_Template_ion_select_ionChange_13_listener() {\n          return ctx.onLocationChange();\n        });\n        i0.ɵɵelementStart(14, \"ion-select-option\", 5);\n        i0.ɵɵtext(15, \"Palapas de gobierno\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"ion-select-option\", 6);\n        i0.ɵɵtext(17, \"Asta bandera / Letras\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"ion-select-option\", 7);\n        i0.ɵɵtext(19, \"Barra de caf\\u00E9\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"ion-select-option\", 8);\n        i0.ɵɵtext(21, \"Papeler\\u00EDa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"ion-select-option\", 9);\n        i0.ɵɵtext(23, \"Palapas de IA\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"ion-select-option\", 10);\n        i0.ɵɵtext(25, \"Cafeter\\u00EDa\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"ion-select-option\", 11);\n        i0.ɵɵtext(27, \"Laboratorios planta baja\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"ion-select-option\", 12);\n        i0.ɵɵtext(29, \"Otro\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(30, DeliveryPage_ion_item_30_Template, 4, 1, \"ion-item\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"div\", 14)(32, \"ion-button\", 15);\n        i0.ɵɵlistener(\"click\", function DeliveryPage_Template_ion_button_click_32_listener() {\n          return ctx.confirmDelivery();\n        });\n        i0.ɵɵtext(33, \"Confirmar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"ion-button\", 15);\n        i0.ɵɵlistener(\"click\", function DeliveryPage_Template_ion_button_click_34_listener() {\n          return ctx.closeModal();\n        });\n        i0.ɵɵtext(35, \"Cancelar\");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"translucent\", true);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"fullscreen\", true);\n        i0.ɵɵadvance(9);\n        i0.ɵɵtwoWayProperty(\"ngModel\", ctx.selectedLocation);\n        i0.ɵɵadvance(17);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedLocation === \"Otro\");\n      }\n    },\n    dependencies: [i4.NgIf, i5.NgControlStatus, i5.NgModel, i1.IonButton, i1.IonContent, i1.IonHeader, i1.IonInput, i1.IonItem, i1.IonLabel, i1.IonList, i1.IonSelect, i1.IonSelectOption, i1.IonTitle, i1.IonToolbar, i1.SelectValueAccessor, i1.TextValueAccessor]\n  });\n  return DeliveryPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}